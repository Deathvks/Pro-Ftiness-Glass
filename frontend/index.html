<!doctype html>
<html lang="es">

<head>
  <meta charset="UTF-8" />

  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <meta http-equiv="Content-Security-Policy" content="
      default-src * 'self' 'unsafe-inline' 'unsafe-eval' data: gap: content: blob:;
      style-src * 'self' 'unsafe-inline';
      script-src * 'self' 'unsafe-inline' 'unsafe-eval' blob:;
      worker-src * 'self' blob:;
      img-src * 'self' data: blob:;
      media-src * 'self' data: blob:;
      frame-src * 'self' data: blob:;
      connect-src * 'self' 'unsafe-inline';
    " />

  <link rel="icon" type="image/png" href="/favicon-32x32.png" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=5" />

  <meta name="theme-color" content="#000000" />

  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-title" content="Pro Fitness Glass" />

  <title>Pro Fitness Glass - Tu App de Fitness</title>
  <meta name="description"
    content="Registra tus entrenamientos, sigue tu progreso nutricional y alcanza tus objetivos de fitness con Pro Fitness Glass." />
  <meta name="keywords"
    content="fitness, gym, entrenamiento, nutrición, rutinas, pesas, calorías, macros, salud, deporte, tracker" />

  <link rel="apple-touch-icon" href="/apple-touch-icon.webp">
  <meta name="google-site-verification" content="ARC8lM_i6d5sVoiyNVFvw28qpbyy-Xr7xI5eZBHmaSo" />

  <link rel="preconnect" href="https://accounts.google.com" />

  <meta property="og:type" content="website" />
  <meta property="og:title" content="Pro Fitness Glass - Tu App de Fitness" />
  <meta property="og:description" content="Entrena inteligente. Registra tus rutinas y nutrición fácilmente." />
  <meta property="og:image" content="/logo.webp" />
  <meta property="og:site_name" content="Pro Fitness Glass" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Pro Fitness Glass" />
  <meta name="twitter:description" content="Tu compañero definitivo de entrenamiento y nutrición." />
  <meta name="twitter:image" content="/logo.webp" />

  <style>
    :root {
      /* Valores por defecto */
      --accent-r: 34;
      --accent-g: 197;
      --accent-b: 94; 
      
      /* Base Glass Colors */
      --glass-base: 26, 35, 53; /* Dark Blue Gray */
      --glass-opacity: 0.65;
      --glass-border-opacity: 0.2;
    }

    html.light-theme {
      --glass-base: 255, 255, 255;
      --glass-opacity: 0.75;
      --glass-border-opacity: 0.2;
    }

    html.oled-theme {
      --glass-base: 0, 0, 0;
      --glass-opacity: 0.8;
      --glass-border-opacity: 0.3;
    }

    .app-splash-screen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 9999;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      background-color: inherit; 
      color: #ffffff;
      opacity: 1;
      transition: opacity 0.3s ease;
    }

    .app-splash-spinner {
      width: 48px;
      height: 48px;
      border: 3px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      /* Usamos las variables RGB para el color */
      border-top-color: rgb(var(--accent-r), var(--accent-g), var(--accent-b));
      animation: spin 1s ease-in-out infinite;
      box-shadow: 0 0 20px -5px rgb(var(--accent-r), var(--accent-g), var(--accent-b));
      margin-top: 2rem;
    }

    html.light-theme .app-splash-screen {
      color: #0f172a;
    }

    html.light-theme .app-splash-spinner {
      border-color: rgba(0, 0, 0, 0.05);
      border-top-color: rgb(var(--accent-r), var(--accent-g), var(--accent-b));
    }

    .app-splash-title {
      font-size: 2.5rem;
      font-weight: 800;
      text-align: center;
      line-height: 1.2;
      letter-spacing: -0.02em;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.75rem;
      animation: fadeUp 0.8s ease-out forwards;
      opacity: 0;
    }

    /* BADGE GLASS CON TINTADO COMPATIBLE */
    .app-splash-title span.glass-badge {
      display: inline-block;
      font-size: 1.5rem;
      font-weight: 700;
      letter-spacing: 0.1em;
      padding: 0.5rem 1.5rem;
      border-radius: 1rem;
      
      /* ESTRATEGIA DE CAPAS: Tinte Acento (20%) + Base Glass Theme */
      background-image: 
        linear-gradient(rgba(var(--accent-r), var(--accent-g), var(--accent-b), 0.20), rgba(var(--accent-r), var(--accent-g), var(--accent-b), 0.20)),
        linear-gradient(rgba(var(--glass-base), var(--glass-opacity)), rgba(var(--glass-base), var(--glass-opacity)));
        
      /* Borde tintado */
      border: 1px solid rgba(var(--accent-r), var(--accent-g), var(--accent-b), var(--glass-border-opacity));
      border-top-color: rgba(255, 255, 255, 0.3);
      
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      
      box-shadow: 
        0 4px 6px -1px rgba(0, 0, 0, 0.1),
        0 2px 4px -1px rgba(0, 0, 0, 0.06),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
        
      color: rgb(var(--accent-r), var(--accent-g), var(--accent-b));
      text-transform: uppercase;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>

  <script>
    (function () {
      try {
        // --- MAPA DE COLORES (Debe coincidir con ACCENT_OPTIONS en SettingsScreen) ---
        var accentMap = {
          'green': '#22c55e',
          'blue': '#3b82f6',
          'violet': '#8b5cf6',
          'amber': '#f59e0b',
          'rose': '#f43f5e',
          'teal': '#14b8a6',
          'cyan': '#06b6d4',
          'orange': '#f97316',
          'lime': '#84cc16',
          'fuchsia': '#d946ef',
          'emerald': '#10b981',
          'indigo': '#6366f1',
          'purple': '#a855f7',
          'pink': '#ec4899',
          'red': '#ef4444',
          'yellow': '#eab308',
          'sky': '#0ea5e9',
          'slate': '#64748b',
          'zinc': '#71717a',
          'stone': '#78716c',
          'neutral': '#737373'
        };

        // 1. Recuperar Preferencias
        var savedTheme = localStorage.getItem('theme') || 'system';
        var savedAccentKey = localStorage.getItem('accent') || 'green'; // Puede ser 'blue' o '#3b82f6'
        var systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

        // Limpiar comillas si es un JSON string
        if (savedAccentKey.startsWith('"') && savedAccentKey.endsWith('"')) {
          savedAccentKey = savedAccentKey.slice(1, -1);
        }

        // 2. RESOLVER HEXADECIMAL (Clave o Hex directo)
        var hexColor = accentMap[savedAccentKey] || savedAccentKey;
        
        // Validación básica de Hex, si falla usar Green
        if (!/^#[0-9A-F]{6}$/i.test(hexColor)) {
            hexColor = '#22c55e';
        }

        // 3. FUNCIÓN HEX A RGB
        function hexToRgb(hex) {
          var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
          return result ? {
            r: parseInt(result[1], 16),
            g: parseInt(result[2], 16),
            b: parseInt(result[3], 16)
          } : { r: 34, g: 197, b: 94 };
        }

        var rgb = hexToRgb(hexColor);

        // 4. Inyectar variables RGB en el root
        var root = document.documentElement;
        root.style.setProperty('--app-accent', hexColor);
        root.style.setProperty('--accent-r', rgb.r);
        root.style.setProperty('--accent-g', rgb.g);
        root.style.setProperty('--accent-b', rgb.b);

        // 5. Determinar tema efectivo
        var effectiveTheme = savedTheme;
        if (effectiveTheme === 'system') {
          effectiveTheme = systemDark ? 'dark' : 'light';
        }

        // 6. Colores de Fondo
        var colors = {
          light: '#f7fafc',
          dark: '#0c111b',
          oled: '#000000'
        };
        var selectedColor = colors[effectiveTheme] || colors.dark;
        var statusBarStyle = effectiveTheme === 'light' ? 'default' : 'black-translucent';

        // 7. Aplicar Clases
        root.classList.remove('light-theme', 'dark-theme', 'oled-theme');
        if (savedTheme === 'system') {
          root.classList.add(systemDark ? 'dark-theme' : 'light-theme');
        } else {
          root.classList.add(effectiveTheme + '-theme');
        }

        // Sincronizar background inmediatamente
        root.style.backgroundColor = selectedColor;
        var setBodyColor = function() {
            if(document.body) document.body.style.backgroundColor = selectedColor;
        };
        if(document.body) setBodyColor();
        else document.addEventListener('DOMContentLoaded', setBodyColor);

        // 8. Meta Tags
        var updateMeta = function(name, content) {
            var meta = document.querySelector('meta[name="' + name + '"]');
            if (!meta) {
                meta = document.createElement('meta');
                meta.name = name;
                document.head.appendChild(meta);
            }
            meta.content = content;
        };
        updateMeta("theme-color", selectedColor);
        updateMeta("apple-mobile-web-app-status-bar-style", statusBarStyle);

      } catch (e) {
        console.error('Splash init error', e);
      }
    })();
  </script>
</head>

<body>
  <div id="root">
    <div class="app-splash-screen">
      <div class="app-splash-title">
        PRO FITNESS 
        <span class="glass-badge">GLASS</span>
      </div>
      <div class="app-splash-spinner"></div>
    </div>
  </div>

  <footer style="
      position: relative;
      z-index: 0; 
      padding: 30px 10px;
      text-align: center;
      font-family: system-ui, sans-serif;
      font-size: 12px;
      color: #94a3b8; /* Slate-400 */
      background-color: transparent;
  ">
      <nav style="margin-bottom: 10px;">
          <a href="https://pro-fitness-glass.zeabur.app/privacy" style="color: inherit; text-decoration: none; margin: 0 10px;">Política de Privacidad</a>
          <span style="opacity: 0.5;">|</span>
          <a href="https://pro-fitness-glass.zeabur.app/terms" style="color: inherit; text-decoration: none; margin: 0 10px;">Términos del Servicio</a>
      </nav>
      <div style="opacity: 0.6;">© 2026 Pro Fitness Glass</div>
  </footer>

  <script type="module" src="/src/main.jsx"></script>
</body>

</html>